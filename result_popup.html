<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI í…ŒìŠ¤íŠ¸ ê²°ê³¼</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: #333;
        }
        .result-container {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 700px;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        .result-header {
            margin-bottom: 20px;
        }
        .result-header h1 {
            color: #5D4FFF;
            font-size: 28px;
            margin-bottom: 10px;
        }
        .result-header h2 {
            color: #5D4FFF;
            font-size: 20px;
            font-weight: normal;
            margin-top: 0;
        }
        .result-content {
            margin-bottom: 25px;
            line-height: 1.6;
            text-align: left;
        }
        .result-type {
            font-size: 36px;
            font-weight: bold;
            color: #5D4FFF;
            margin: 10px 0;
        }
        .result-image {
            width: 150px;
            height: 150px;
            margin: 20px auto;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }
        .dimension-bars {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
        }
        .dimension-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .dimension-labels {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 5px;
        }
        .dimension-label {
            font-weight: bold;
            width: 30px;
        }
        .bar-container {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 0 10px;
        }
        .bar-fill {
            height: 100%;
            background-color: #5D4FFF;
            border-radius: 10px;
        }
        .percentage {
            font-size: 14px;
            color: #666;
        }
        .result-description {
            text-align: left;
            margin: 20px 0;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 10px;
        }
        .result-description h3 {
            color: #5D4FFF;
            margin-top: 0;
        }
        .result-footer {
            margin-top: 30px;
        }
        .result-footer button {
            background-color: #5D4FFF;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 30px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 0 10px;
        }
        .result-footer button:hover {
            background-color: #4A3FD1;
        }
        .share-buttons {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 15px;
        }
        .share-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 20px;
        }
        .share-button:hover {
            background-color: #e0e0e0;
        }
        .share-button-copy {
            background-color: #f0f0f0;
        }
        .share-button-zep {
            background-color: #5D4FFF;
            color: white;
        }
        .tooltip {
            position: absolute;
            background-color: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }
        .share-button-container {
            position: relative;
            display: inline-block;
        }
        .share-area {
            margin-top: 15px;
        }
        .share-text-container {
            width: 90%;
            max-width: 500px;
            margin: 15px auto 5px auto;
            display: none;
        }
        .share-text-label {
            font-size: 14px;
            color: #555;
            text-align: left;
            margin-bottom: 5px;
        }
        .share-text-area {
            width: 100%;
            height: 120px;
            padding: 10px;
            border-radius: 5px;
            border: 2px solid #5D4FFF;
            background-color: #f9f9f9;
            font-size: 14px;
            resize: none;
            color: #333;
            font-family: 'Noto Sans KR', sans-serif;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-word;
            margin: 0;
        }
        .copy-success {
            display: none;
            color: #5D4FFF;
            margin-top: 5px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="result-container">
        <div class="result-header">
            <h1>MBTI í…ŒìŠ¤íŠ¸ ê²°ê³¼</h1>
            <h2>ë‹¹ì‹ ì˜ ì„±ê²© ìœ í˜•ì€...</h2>
        </div>
        
        <div class="result-type" id="mbti-type">ENFP</div>
        <div class="result-image" id="mbti-image"></div>
        
        <div class="dimension-bars">
            <div class="dimension-bar">
                <div class="dimension-label">E</div>
                <div class="bar-container">
                    <div class="bar-fill" id="e-bar" style="width: 70%;"></div>
                </div>
                <div class="dimension-label">I</div>
                <div class="percentage" id="ei-percentage">E 70% / I 30%</div>
            </div>
            
            <div class="dimension-bar">
                <div class="dimension-label">S</div>
                <div class="bar-container">
                    <div class="bar-fill" id="s-bar" style="width: 45%;"></div>
                </div>
                <div class="dimension-label">N</div>
                <div class="percentage" id="sn-percentage">S 45% / N 55%</div>
            </div>
            
            <div class="dimension-bar">
                <div class="dimension-label">T</div>
                <div class="bar-container">
                    <div class="bar-fill" id="t-bar" style="width: 35%;"></div>
                </div>
                <div class="dimension-label">F</div>
                <div class="percentage" id="tf-percentage">T 35% / F 65%</div>
            </div>
            
            <div class="dimension-bar">
                <div class="dimension-label">J</div>
                <div class="bar-container">
                    <div class="bar-fill" id="j-bar" style="width: 20%;"></div>
                </div>
                <div class="dimension-label">P</div>
                <div class="percentage" id="jp-percentage">J 20% / P 80%</div>
            </div>
        </div>
        
        <div class="result-description">
            <h3 id="mbti-nickname">ì—´ì •ì ì¸ í™œë™ê°€ (ENFP)</h3>
            <p id="mbti-description">ì—´ì •ì ì´ê³  ì°½ì˜ì ì¸ ì„±ê²©ìœ¼ë¡œ, í•­ìƒ ìƒˆë¡œìš´ ê°€ëŠ¥ì„±ì„ ì°¾ê³  ë‹¤ì–‘í•œ ì•„ì´ë””ì–´ë¥¼ ì‹œë„í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ë¥¼ ì¤‘ìš”ì‹œí•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒì˜ ê°ì •ì„ ì˜ ì´í•´í•˜ê³  ê³µê°í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ììœ ë¡œìš´ ë¶„ìœ„ê¸°ì—ì„œ ì¼í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ë©°, ê·œì¹™ì´ë‚˜ í‹€ì— ì–½ë§¤ì´ëŠ” ê²ƒì„ ì¢‹ì•„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        </div>
        
        <div class="share-area">
            <h3>ê²°ê³¼ ê³µìœ í•˜ê¸°</h3>
            <div class="share-buttons">
                <div class="share-button-container">
                    <div class="share-button share-button-copy" id="copy-result">
                        <span>ğŸ“‹</span>
                    </div>
                    <div class="tooltip">ê²°ê³¼ ë³µì‚¬í•˜ê¸°</div>
                </div>
                <div class="share-button-container">
                    <div class="share-button share-button-zep" id="share-with-zep">
                        <span>Z</span>
                    </div>
                    <div class="tooltip">Zep ëŒ€í™”ì°½ì— ê³µìœ í•˜ê¸°</div>
                </div>
            </div>
            <div id="copy-success" class="copy-success">âœ“ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤</div>
            <div class="share-text-container">
                <p class="share-text-label">ì•„ë˜ í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë©ë‹ˆë‹¤:</p>
                <textarea id="share-text-area" class="share-text-area" readonly></textarea>
            </div>
        </div>
        
        <div class="result-footer">
            <button id="close-result">ë‹«ê¸°</button>
            <button id="retry-test">ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°</button>
        </div>
    </div>

    <script>
        let mbtiResult = null;
        let shareText = "";
        
        // ì•±ì—ì„œ ìœ„ì ¯ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´ ë™ì‘í•˜ëŠ” í•¨ìˆ˜
        window.addEventListener("message", function(e) {
            if (e.data && e.data.mbtiResult) {
                updateResult(e.data.mbtiResult);
            }
        });
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê²°ê³¼ ìš”ì²­
        document.addEventListener('DOMContentLoaded', function() {
            // ì•±ì— ê²°ê³¼ ë°ì´í„° ìš”ì²­
            sendMessageToApp({
                type: "REQUEST_MBTI_RESULT"
            });
            
            // ê³µìœ  ë²„íŠ¼ì— íˆ´íŒ ì´ë²¤íŠ¸ ì¶”ê°€
            document.querySelectorAll('.share-button-container').forEach(container => {
                const tooltip = container.querySelector('.tooltip');
                
                container.addEventListener('mouseenter', function() {
                    tooltip.style.opacity = '1';
                });
                
                container.addEventListener('mouseleave', function() {
                    tooltip.style.opacity = '0';
                });
            });
            
            // í…ŒìŠ¤íŠ¸ìš© ë”ë¯¸ ë°ì´í„° (ì‹¤ì œë¡œëŠ” ì•±ì—ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜´)
            /*
            updateResult({
                mbtiType: "ENFP",
                percentages: {
                    EI: "E 70% / I 30%",
                    SN: "S 45% / N 55%", 
                    TF: "T 35% / F 65%",
                    JP: "J 20% / P 80%"
                }
            });
            */
        });
        
        function updateResult(result) {
            mbtiResult = result;
            const mbtiType = result.mbtiType || "ENFP";
            document.getElementById('mbti-type').textContent = mbtiType;
            
            // ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
            const imageElement = document.getElementById('mbti-image');
            imageElement.style.backgroundImage = `url('mbti/${mbtiType}.png')`;
            
            // ë°±ë¶„ìœ¨ í‘œì‹œ ë° ë°” ì—…ë°ì´íŠ¸
            if (result.percentages) {
                const percentages = result.percentages;
                
                if (percentages.EI) {
                    document.getElementById('ei-percentage').textContent = percentages.EI;
                    const eiMatch = percentages.EI.match(/E\s*(\d+)%/);
                    if (eiMatch && eiMatch[1]) {
                        document.getElementById('e-bar').style.width = `${eiMatch[1]}%`;
                    }
                }
                
                if (percentages.SN) {
                    document.getElementById('sn-percentage').textContent = percentages.SN;
                    const snMatch = percentages.SN.match(/S\s*(\d+)%/);
                    if (snMatch && snMatch[1]) {
                        document.getElementById('s-bar').style.width = `${snMatch[1]}%`;
                    }
                }
                
                if (percentages.TF) {
                    document.getElementById('tf-percentage').textContent = percentages.TF;
                    const tfMatch = percentages.TF.match(/T\s*(\d+)%/);
                    if (tfMatch && tfMatch[1]) {
                        document.getElementById('t-bar').style.width = `${tfMatch[1]}%`;
                    }
                }
                
                if (percentages.JP) {
                    document.getElementById('jp-percentage').textContent = percentages.JP;
                    const jpMatch = percentages.JP.match(/J\s*(\d+)%/);
                    if (jpMatch && jpMatch[1]) {
                        document.getElementById('j-bar').style.width = `${jpMatch[1]}%`;
                    }
                }
            }
            
            // MBTI ìœ í˜•ë³„ ì„¤ëª… ë° ë³„ëª… ì—…ë°ì´íŠ¸
            const mbtiDescriptions = {
                "ISTJ": {
                    nickname: "ì²­ë ´ê²°ë°±í•œ ë…¼ë¦¬ì£¼ì˜ì (ISTJ)",
                    description: "ì²´ê³„ì ì´ê³  ì‚¬ì‹¤ì ì¸ ì„±ê²©ìœ¼ë¡œ, ì±…ì„ê°ì´ ê°•í•˜ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì…ë‹ˆë‹¤. ë…¼ë¦¬ì ì´ê³  ì²´ê³„ì ìœ¼ë¡œ ì¼ì„ ì²˜ë¦¬í•˜ë©°, ì„¸ë¶€ ì‚¬í•­ì— ì£¼ì˜ë¥¼ ê¸°ìš¸ì´ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì „í†µì ì¸ ê°€ì¹˜ë¥¼ ì¤‘ìš”ì‹œí•˜ë©° ì•½ì†ì„ ì§€í‚¤ëŠ” ê²ƒì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤."
                },
                "ISFJ": {
                    nickname: "ìš©ê°í•œ ìˆ˜í˜¸ì (ISFJ)",
                    description: "ë‹¤ì •í•˜ê³  ì±…ì„ê° ìˆëŠ” ì„±ê²©ìœ¼ë¡œ, ë‹¤ë¥¸ ì‚¬ëŒì˜ í•„ìš”ì— ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•©ë‹ˆë‹¤. ì„¸ë¶€ ì‚¬í•­ì— ì£¼ì˜ë¥¼ ê¸°ìš¸ì´ê³  ë‹¤ë¥¸ ì‚¬ëŒì„ ë°°ë ¤í•˜ë©° ë„ì›€ì„ ì£¼ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì „í†µê³¼ ì•ˆì •ì„±ì„ ì¤‘ìš”ì‹œí•˜ë©°, ì¡°ìš©í•˜ê³  ì§„ì‹¤ëœ ê´€ê³„ë¥¼ ì„ í˜¸í•©ë‹ˆë‹¤."
                },
                "INFJ": {
                    nickname: "ì„ ì˜ì˜ ì˜¹í˜¸ì (INFJ)",
                    description: "ì´ìƒì£¼ì˜ì ì´ê³  ì›ì¹™ì ì¸ ì„±ê²©ìœ¼ë¡œ, ë‹¤ë¥¸ ì‚¬ëŒê³¼ ì„¸ìƒì„ ë” ë‚˜ì€ ê³³ìœ¼ë¡œ ë§Œë“¤ê³ ì í•˜ëŠ” ê°•í•œ ì—´ë§ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. í†µì°°ë ¥ì´ ë›°ì–´ë‚˜ë©° ë‹¤ë¥¸ ì‚¬ëŒì˜ ê°ì •ê³¼ ë™ê¸°ë¥¼ ì˜ ì´í•´í•©ë‹ˆë‹¤. ì§„ì‹¤ëœ ê´€ê³„ì™€ ì˜ë¯¸ ìˆëŠ” ì¼ì„ ì¶”êµ¬í•©ë‹ˆë‹¤."
                },
                "INTJ": {
                    nickname: "ìš©ì˜ì£¼ë„í•œ ì „ëµê°€ (INTJ)",
                    description: "ë…ë¦½ì ì´ê³  ë¶„ì„ì ì¸ ì„±ê²©ìœ¼ë¡œ, ë³µì¡í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì§€ì  í˜¸ê¸°ì‹¬ì´ ë§ìœ¼ë©° ìƒˆë¡œìš´ ì•„ì´ë””ì–´ì™€ ê°œë…ì„ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ëª©í‘œ ì§€í–¥ì ì´ê³  ë¹„íŒì ì¸ ì‚¬ê³ ë¥¼ í†µí•´ íš¨ìœ¨ì ì¸ í•´ê²°ì±…ì„ ì°¾ì•„ëƒ…ë‹ˆë‹¤."
                },
                "ISTP": {
                    nickname: "ë§ŒëŠ¥ ì¬ì£¼ê¾¼ (ISTP)",
                    description: "ë…¼ë¦¬ì ì´ê³  ì‹¤ìš©ì ì¸ ì„±ê²©ìœ¼ë¡œ, ë¬¸ì œ í•´ê²°ì— ë›°ì–´ë‚œ ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ê¸°ê³„ì ì¸ ì‘ì—…ì´ë‚˜ ì†ìœ¼ë¡œ í•˜ëŠ” ì‘ì—…ì„ ì¦ê¸°ë©°, í˜„ì¬ì˜ ìƒí™©ì— ì§‘ì¤‘í•˜ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤. ë…ë¦½ì ì´ê³  ììœ ë¥¼ ì¶”êµ¬í•˜ë©°, ìì‹ ë§Œì˜ ë°©ì‹ìœ¼ë¡œ ì¼í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤."
                },
                "ISFP": {
                    nickname: "í˜¸ê¸°ì‹¬ ë§ì€ ì˜ˆìˆ ê°€ (ISFP)",
                    description: "ê°ì„±ì ì´ê³  ì˜ˆìˆ ì ì¸ ì„±ê²©ìœ¼ë¡œ, ì•„ë¦„ë‹¤ì›€ê³¼ ê°ê°ì ì¸ ê²½í—˜ì„ ì¤‘ìš”ì‹œí•©ë‹ˆë‹¤. ìì‹ ë§Œì˜ ê°€ì¹˜ê´€ì„ ê°€ì§€ê³  ìˆìœ¼ë©°, ì¡°ìš©í•˜ê³  ê²¸ì†í•œ íƒœë„ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤. í˜„ì¬ì— ì§‘ì¤‘í•˜ë©° ìì—°ìŠ¤ëŸ½ê³  ììœ ë¡œìš´ ì‚¶ì„ ì¶”êµ¬í•©ë‹ˆë‹¤."
                },
                "INFP": {
                    nickname: "ì—´ì •ì ì¸ ì¤‘ì¬ì (INFP)",
                    description: "ì´ìƒì£¼ì˜ì ì´ê³  ì°½ì˜ì ì¸ ì„±ê²©ìœ¼ë¡œ, ìì‹ ì˜ ê°€ì¹˜ê´€ì— ë”°ë¼ ì‚´ì•„ê°‘ë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ëŒì˜ ê°ì •ì— ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•˜ë©°, ì¡°í™”ì™€ ì´í•´ë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤. ë‚´ë©´ì˜ ì„¸ê³„ê°€ í’ë¶€í•˜ê³  ìƒìƒë ¥ì´ í’ë¶€í•˜ë©°, ìì‹ ì˜ ë…íŠ¹í•œ ë°©ì‹ìœ¼ë¡œ ì„¸ìƒì— ê¸°ì—¬í•˜ê³ ì í•©ë‹ˆë‹¤."
                },
                "INTP": {
                    nickname: "ë…¼ë¦¬ì ì¸ ì‚¬ìƒ‰ê°€ (INTP)",
                    description: "ì§€ì  í˜¸ê¸°ì‹¬ì´ ë§ê³  ë¶„ì„ì ì¸ ì„±ê²©ìœ¼ë¡œ, ë³µì¡í•œ ì´ë¡ ê³¼ ì•„ì´ë””ì–´ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ë…¼ë¦¬ì ìœ¼ë¡œ ì‚¬ê³ í•˜ë©° ë¬¸ì œì˜ ê·¼ë³¸ì ì¸ ì›ë¦¬ë¥¼ ì´í•´í•˜ê³ ì í•©ë‹ˆë‹¤. ë…ë¦½ì ì´ê³  ì°½ì˜ì ì¸ ì‚¬ê³ ë¥¼ í†µí•´ ìƒˆë¡œìš´ ì§€ì‹ì„ ì¶”êµ¬í•©ë‹ˆë‹¤."
                },
                "ESTP": {
                    nickname: "ëª¨í—˜ì„ ì¦ê¸°ëŠ” ì‚¬ì—…ê°€ (ESTP)",
                    description: "í™œë™ì ì´ê³  ì‹¤ìš©ì ì¸ ì„±ê²©ìœ¼ë¡œ, í˜„ì¬ì˜ ìƒí™©ì— ì§‘ì¤‘í•˜ê³  ì¦‰ê°ì ì¸ ê²°ê³¼ë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤. ìœ„í—˜ì„ ê°ìˆ˜í•˜ëŠ” ê²ƒì„ ë‘ë ¤ì›Œí•˜ì§€ ì•Šìœ¼ë©°, ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì‚¬êµì ì´ê³  ì ì‘ë ¥ì´ ê°•í•˜ë©°, ìƒˆë¡œìš´ ê²½í—˜ì„ ì¦ê¹ë‹ˆë‹¤."
                },
                "ESFP": {
                    nickname: "ììœ ë¡œìš´ ì˜í˜¼ì˜ ì—°ì˜ˆì¸ (ESFP)",
                    description: "ì—´ì •ì ì´ê³  ì¦ê±°ì›€ì„ ì¶”êµ¬í•˜ëŠ” ì„±ê²©ìœ¼ë¡œ, ì‚¬ëŒë“¤ê³¼ í•¨ê»˜í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. í˜„ì¬ì— ì§‘ì¤‘í•˜ë©° ê°ê°ì ì¸ ê²½í—˜ì„ ì¤‘ìš”ì‹œí•©ë‹ˆë‹¤. ì‚¬êµì ì´ê³  ë§¤ë ¥ì ì¸ ì„±ê²©ìœ¼ë¡œ, ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ê¸°ì¨ê³¼ í¥ë¯¸ë¥¼ ë¶ˆëŸ¬ì¼ìœ¼í‚µë‹ˆë‹¤."
                },
                "ENFP": {
                    nickname: "ì—´ì •ì ì¸ í™œë™ê°€ (ENFP)",
                    description: "ì—´ì •ì ì´ê³  ì°½ì˜ì ì¸ ì„±ê²©ìœ¼ë¡œ, í•­ìƒ ìƒˆë¡œìš´ ê°€ëŠ¥ì„±ì„ ì°¾ê³  ë‹¤ì–‘í•œ ì•„ì´ë””ì–´ë¥¼ ì‹œë„í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ë¥¼ ì¤‘ìš”ì‹œí•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒì˜ ê°ì •ì„ ì˜ ì´í•´í•˜ê³  ê³µê°í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ììœ ë¡œìš´ ë¶„ìœ„ê¸°ì—ì„œ ì¼í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ë©°, ê·œì¹™ì´ë‚˜ í‹€ì— ì–½ë§¤ì´ëŠ” ê²ƒì„ ì¢‹ì•„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
                },
                "ENTP": {
                    nickname: "ë…¼ìŸì„ ì¦ê¸°ëŠ” ë³€ë¡ ê°€ (ENTP)",
                    description: "ì§€ì  í˜¸ê¸°ì‹¬ì´ ë§ê³  ì°½ì˜ì ì¸ ì„±ê²©ìœ¼ë¡œ, ìƒˆë¡œìš´ ì•„ì´ë””ì–´ì™€ ê°€ëŠ¥ì„±ì„ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ë…¼ë¦¬ì ìœ¼ë¡œ ì‚¬ê³ í•˜ë©° ë‹¤ì–‘í•œ ê´€ì ì—ì„œ ë¬¸ì œë¥¼ ë°”ë¼ë³´ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ë„ì „ì ì¸ í† ë¡ ì„ ì¦ê¸°ë©°, ê·œì¹™ì´ë‚˜ ê´€ìŠµì— ì–½ë§¤ì´ì§€ ì•Šê³  ììœ ë¡­ê²Œ ìƒê°í•©ë‹ˆë‹¤."
                },
                "ESTJ": {
                    nickname: "ì—„ê²©í•œ ê´€ë¦¬ì (ESTJ)",
                    description: "ì²´ê³„ì ì´ê³  ì‹¤ìš©ì ì¸ ì„±ê²©ìœ¼ë¡œ, ì±…ì„ê°ì´ ê°•í•˜ê³  ê²°ê³¼ ì§€í–¥ì ì…ë‹ˆë‹¤. ë…¼ë¦¬ì ìœ¼ë¡œ ì‚¬ê³ í•˜ë©° íš¨ìœ¨ì ì¸ ë°©ì‹ìœ¼ë¡œ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê³ ì í•©ë‹ˆë‹¤. ì „í†µê³¼ ì§ˆì„œë¥¼ ì¤‘ìš”ì‹œí•˜ë©°, ë¦¬ë”ì‹­ì„ ë°œíœ˜í•˜ì—¬ ì¡°ì§ì„ ì´ë„ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤."
                },
                "ESFJ": {
                    nickname: "ì‚¬êµì ì¸ ì™¸êµê´€ (ESFJ)",
                    description: "ë‹¤ì •í•˜ê³  ë°°ë ¤ì‹¬ì´ ë§ì€ ì„±ê²©ìœ¼ë¡œ, ë‹¤ë¥¸ ì‚¬ëŒì˜ í•„ìš”ì— ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•©ë‹ˆë‹¤. ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ë¥¼ ì¤‘ìš”ì‹œí•˜ë©°, ì¡°í™”ë¡œìš´ í™˜ê²½ì„ ë§Œë“¤ê³ ì í•©ë‹ˆë‹¤. ì±…ì„ê°ì´ ê°•í•˜ê³  í˜‘ë ¥ì ì´ë©°, ë‹¤ë¥¸ ì‚¬ëŒì„ ë„ìš°ë©° ê¸°ì¨ì„ ëŠë‚ë‹ˆë‹¤."
                },
                "ENFJ": {
                    nickname: "ì •ì˜ë¡œìš´ ì‚¬íšŒìš´ë™ê°€ (ENFJ)",
                    description: "ë”°ëœ»í•˜ê³  ì´íƒ€ì ì¸ ì„±ê²©ìœ¼ë¡œ, ë‹¤ë¥¸ ì‚¬ëŒì˜ ì ì¬ë ¥ì„ ëŒì–´ë‚´ê³  ì„±ì¥ì„ ë•ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ê°ì •ì ìœ¼ë¡œ ê³µê°í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ë©°, ì¡°í™”ì™€ í˜‘ë ¥ì„ ì¤‘ìš”ì‹œí•©ë‹ˆë‹¤. ì¹´ë¦¬ìŠ¤ë§ˆ ìˆëŠ” ë¦¬ë”ì‹­ì„ ë°œíœ˜í•˜ì—¬ ê¸ì •ì ì¸ ë³€í™”ë¥¼ ì´ëŒì–´ë‚´ê³ ì í•©ë‹ˆë‹¤."
                },
                "ENTJ": {
                    nickname: "ëŒ€ë‹´í•œ í†µì†”ì (ENTJ)",
                    description: "ìì‹ ê° ìˆê³  ê²°ë‹¨ë ¥ ìˆëŠ” ì„±ê²©ìœ¼ë¡œ, ì¥ê¸°ì ì¸ ë¹„ì „ê³¼ ëª©í‘œë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ë…¼ë¦¬ì ìœ¼ë¡œ ì‚¬ê³ í•˜ë©° íš¨ìœ¨ì ì¸ ì „ëµì„ ì„¸ìš°ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ë¦¬ë”ì‹­ì„ ë°œíœ˜í•˜ì—¬ ì¡°ì§ì„ ì´ëŒê³ , ë„ì „ì ì¸ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ë…¸ë ¥í•©ë‹ˆë‹¤."
                }
            };
            
            const mbtiInfo = mbtiDescriptions[mbtiType] || mbtiDescriptions["ENFP"];
            document.getElementById('mbti-nickname').textContent = mbtiInfo.nickname;
            document.getElementById('mbti-description').textContent = mbtiInfo.description;
            
            // ê³µìœ  í…ìŠ¤íŠ¸ ìƒì„±
            createShareText(mbtiType, mbtiInfo, result.percentages);
        }
        
        // ê³µìœ ìš© í…ìŠ¤íŠ¸ ìƒì„± í•¨ìˆ˜
        function createShareText(mbtiType, mbtiInfo, percentages) {
            shareText = `[MBTI í…ŒìŠ¤íŠ¸ ê²°ê³¼]\n\n`;
            shareText += `ğŸ† ë‚˜ì˜ MBTI: ${mbtiType}\n`;
            shareText += `âœ¨ ${mbtiInfo.nickname}\n\n`;
            
            if (percentages) {
                shareText += `ğŸ” ì„±í–¥ ë¶„ì„:\n`;
                shareText += `${percentages.EI}\n`;
                shareText += `${percentages.SN}\n`;
                shareText += `${percentages.TF}\n`;
                shareText += `${percentages.JP}\n\n`;
            }
            
            shareText += `ğŸ’¬ ${mbtiInfo.description.substring(0, 100)}...\n\n`;
            shareText += `âœ… Zep MBTI í…ŒìŠ¤íŠ¸ì—ì„œ í™•ì¸í•˜ì„¸ìš”!`;
            
            // ê³µìœ  í…ìŠ¤íŠ¸ë¥¼ í…ìŠ¤íŠ¸ ì˜ì—­ì— ì„¤ì •
            document.getElementById('share-text-area').value = shareText;
        }
        
        // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
        document.getElementById('close-result').addEventListener('click', function() {
            sendMessageToApp({
                type: "CLOSE_RESULT"
            });
        });
        
        document.getElementById('retry-test').addEventListener('click', function() {
            sendMessageToApp({
                type: "RETRY_MBTI_TEST"
            });
        });
        
        // ê²°ê³¼ ë³µì‚¬ ë²„íŠ¼
        document.getElementById('copy-result').addEventListener('click', function() {
            // TextArea í‘œì‹œ ë° ë‚´ìš© ì„¤ì • (ëª¨ë“  ê²½ìš°ì—)
            const textContainer = document.querySelector('.share-text-container');
            const textArea = document.getElementById('share-text-area');
            textContainer.style.display = 'block';
            textArea.value = shareText;
            
            try {
                // í´ë¦½ë³´ë“œì— ì§ì ‘ ë³µì‚¬ (í˜„ëŒ€ì ì¸ ë°©ì‹)
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(shareText)
                        .then(() => {
                            const copySuccess = document.getElementById('copy-success');
                            copySuccess.style.display = 'block';
                            
                            // ì„±ê³µ ë©”ì‹œì§€ëŠ” 2ì´ˆ í›„ ìˆ¨ê¹€
                            setTimeout(() => {
                                copySuccess.style.display = 'none';
                            }, 2000);
                        })
                        .catch(err => {
                            console.error('í´ë¦½ë³´ë“œ API ì‚¬ìš© ì‹¤íŒ¨:', err);
                            fallbackCopy();
                        });
                } else {
                    fallbackCopy();
                }
            } catch (err) {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('í´ë¦½ë³´ë“œ ë³µì‚¬ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤. í…ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ì„ íƒí•˜ì—¬ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
            }
        });
        
        // ëŒ€ì²´ ë³µì‚¬ ë°©ë²• (ì´ì „ ë°©ì‹)
        function fallbackCopy() {
            const textArea = document.getElementById('share-text-area');
            
            try {
                textArea.focus();
                textArea.select();
                const successful = document.execCommand('copy');
                
                if (successful) {
                    const copySuccess = document.getElementById('copy-success');
                    copySuccess.style.display = 'block';
                    
                    setTimeout(() => {
                        copySuccess.style.display = 'none';
                    }, 2000);
                } else {
                    throw new Error('ë³µì‚¬ ì‹¤íŒ¨');
                }
            } catch (err) {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('í´ë¦½ë³´ë“œ ë³µì‚¬ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤. í…ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ì„ íƒí•˜ì—¬ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
            }
        }
        
        // Zep ëŒ€í™”ì°½ì— ê³µìœ í•˜ê¸° ë²„íŠ¼
        document.getElementById('share-with-zep').addEventListener('click', function() {
            // í…ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ í‘œì‹œ
            const textContainer = document.querySelector('.share-text-container');
            const textArea = document.getElementById('share-text-area');
            textContainer.style.display = 'block';
            textArea.value = shareText;
            
            // ì•±ìœ¼ë¡œ ê³µìœ  ë©”ì‹œì§€ ì „ì†¡
            sendMessageToApp({
                type: "SHARE_TO_ZEP_CHAT",
                content: shareText
            });
            
            const copySuccess = document.getElementById('copy-success');
            copySuccess.textContent = "âœ“ Zep ì±„íŒ…ì— ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤";
            copySuccess.style.display = 'block';
            
            setTimeout(() => {
                copySuccess.style.display = 'none';
                copySuccess.textContent = "âœ“ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤";
            }, 2000);
        });
        
        // ì•±ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” í•¨ìˆ˜
        function sendMessageToApp(data) {
            window.parent.postMessage(data, "*");
        }
    </script>
</body>
</html> 